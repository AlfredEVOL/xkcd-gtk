---

language: go
go:
  - "1.13.x"  # ubuntu focal
  - "1.x"     # latest

dist: focal

addons:
  apt:
    packages:
      - appstream-util
      - golint
      - libgtk-3-dev
      - libxml2-utils
      - yamllint

cache:
  directories:
    - $HOME/.cache/go-build

script:
  - make
  - make check
  - make test

jobs:
  allow_failures:
    - language: node_js

  include:
    - name: Houston CI
      language: node_js
      node_js: "10.17.0"
      services:
        - docker
      before_install:
        - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test
        - sudo apt-get -q update
        - sudo apt-get -y install libstdc++-5-dev
      install:
        - npm i -g @elementaryos/houston
      script:
        - houston ci
